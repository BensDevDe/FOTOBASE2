{"ast":null,"code":"import _asyncToGenerator from\"/home/user/codeLocal/FOTOBASE2/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/user/codeLocal/FOTOBASE2/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/user/codeLocal/FOTOBASE2/client/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect}from\"react\";import SignUpContext from\"./SignUpContext\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";var SignUpState=function SignUpState(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isShowLogin=_useState2[0],setIsShowLogin=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isShowUpload=_useState4[0],setIsShowUpload=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isRegistered=_useState6[0],SetIsRegistered=_useState6[1];var _useState7=useState({firstName:\"-\",lastName:\"\",email:\"\",street:\"\",city:\"\",postcode:\"\",country:\"\",birthday:\"\",password:\"\"}),_useState8=_slicedToArray(_useState7,2),newUser=_useState8[0],setNewUser=_useState8[1];var loginSession=JSON.parse(sessionStorage.getItem(\"login\"))||{isAuthenticated:false};var resultSession=JSON.parse(sessionStorage.getItem(\"result\"))||{result:null};var _useState9=useState(loginSession[\"isAuthenticated\"]),_useState10=_slicedToArray(_useState9,2),isAuthenticated=_useState10[0],setIsAuthenticated=_useState10[1];var _useState11=useState(resultSession[\"result\"]),_useState12=_slicedToArray(_useState11,2),result=_useState12[0],setResult=_useState12[1];console.log(result);var handleLoginClick=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!isAuthenticated){_context.next=7;break;}setIsAuthenticated(false);_context.next=4;return axios.get(\"http://localhost:3001/user/logout\",{withCredentials:true});case 4:response=_context.sent;_context.next=9;break;case 7:setIsShowLogin(function(isShowLogin){return!isShowLogin;});SetIsRegistered(function(isRegistered){return!isRegistered;});case 9:case\"end\":return _context.stop();}}},_callee);}));return function handleLoginClick(){return _ref.apply(this,arguments);};}();var handleLogout=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.get(\"http://localhost:3001/user/logout\",{withCredentials:true});case 3:response=_context2.sent;setIsAuthenticated(false);sessionStorage.removeItem(result);console.log(result);_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[0,9]]);}));return function handleLogout(){return _ref2.apply(this,arguments);};}();var handleUploadClick=function handleUploadClick(){if(isAuthenticated){setIsShowUpload(function(isShowUpload){return!isShowUpload;});}else{return;}};useEffect(function(){sessionStorage.setItem(\"login\",JSON.stringify({isAuthenticated:isAuthenticated}));sessionStorage.setItem(\"result\",JSON.stringify({result:result}));},[isAuthenticated]);return/*#__PURE__*/_jsx(SignUpContext.Provider,{value:{isShowLogin:isShowLogin,setIsShowLogin:setIsShowLogin,handleLoginClick:handleLoginClick,handleUploadClick:handleUploadClick,isShowUpload:isShowUpload,isAuthenticated:isAuthenticated,setIsAuthenticated:setIsAuthenticated,result:result,setResult:setResult,newUser:newUser,setNewUser:setNewUser,isRegistered:isRegistered,SetIsRegistered:SetIsRegistered,handleLogout:handleLogout},children:props.children});};export default SignUpState;","map":{"version":3,"sources":["/home/user/codeLocal/FOTOBASE2/client/src/components/context/SignUpState.js"],"names":["React","useState","useEffect","SignUpContext","axios","SignUpState","props","isShowLogin","setIsShowLogin","isShowUpload","setIsShowUpload","isRegistered","SetIsRegistered","firstName","lastName","email","street","city","postcode","country","birthday","password","newUser","setNewUser","loginSession","JSON","parse","sessionStorage","getItem","isAuthenticated","resultSession","result","setIsAuthenticated","setResult","console","log","handleLoginClick","get","withCredentials","response","handleLogout","removeItem","handleUploadClick","setItem","stringify","children"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport SignUpContext from \"./SignUpContext\";\nimport axios from \"axios\";\n\nconst SignUpState = (props) => {\n  const [isShowLogin, setIsShowLogin] = useState(false);\n  const [isShowUpload, setIsShowUpload] = useState(false);\n\n  const [isRegistered, SetIsRegistered] = useState(false);\n\n  const [newUser, setNewUser] = useState({\n    firstName: \"-\",\n    lastName: \"\",\n    email: \"\",\n    street: \"\",\n    city: \"\",\n    postcode: \"\",\n    country: \"\",\n    birthday: \"\",\n    password: \"\",\n  });\n  const loginSession = JSON.parse(sessionStorage.getItem(\"login\")) || {\n    isAuthenticated: false,\n  };\n\n  const resultSession = JSON.parse(sessionStorage.getItem(\"result\")) || {\n    result: null,\n  };\n\n  const [isAuthenticated, setIsAuthenticated] = useState(\n    loginSession[\"isAuthenticated\"]\n  );\n  const [result, setResult] = useState(resultSession[\"result\"]);\n\n  console.log(result);\n  const handleLoginClick = async () => {\n    if (isAuthenticated) {\n      setIsAuthenticated(false);\n\n      const response = await axios.get(\"http://localhost:3001/user/logout\", {\n        withCredentials: true,\n      });\n    } else {\n      setIsShowLogin((isShowLogin) => !isShowLogin);\n      SetIsRegistered((isRegistered) => !isRegistered);\n    }\n  };\n\n  const handleLogout = async () => {\n    try {\n      const response = await axios.get(\"http://localhost:3001/user/logout\", {\n        withCredentials: true,\n      });\n      setIsAuthenticated(false);\n      sessionStorage.removeItem(result);\n      console.log(result);\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const handleUploadClick = () => {\n    if (isAuthenticated) {\n      setIsShowUpload((isShowUpload) => !isShowUpload);\n    } else {\n      return;\n    }\n  };\n\n  useEffect(() => {\n    sessionStorage.setItem(\n      \"login\",\n      JSON.stringify({ isAuthenticated: isAuthenticated })\n    );\n    sessionStorage.setItem(\"result\", JSON.stringify({ result: result }));\n  }, [isAuthenticated]);\n  return (\n    <SignUpContext.Provider\n      value={{\n        isShowLogin,\n        setIsShowLogin,\n        handleLoginClick,\n        handleUploadClick,\n        isShowUpload,\n        isAuthenticated,\n        setIsAuthenticated,\n        result,\n        setResult,\n\n        newUser,\n        setNewUser,\n        isRegistered,\n        SetIsRegistered,\n        handleLogout,\n      }}\n    >\n      {props.children}\n    </SignUpContext.Provider>\n  );\n};\n\nexport default SignUpState;\n"]},"metadata":{},"sourceType":"module"}